<% if !collage.nil? -%>
<li class="listitem listitem<%= collage.id %>" data-itemid="<%= collage.id %>">
  <span class="list-icon icon icon-collage"></span>
  <div class="details">
    <h4>
      <%= link_to collage.name, collage_path(collage), :class => "title" %>
      <% if current_user && (@is_admin[:collage] || @my_belongings[:collages].include?(collage)) %>
        <%= link_to 'DELETE', collage, :class => "icon icon-delete tooltip", :title => "Delete" %>
        <% end %>
    </h4>
    <p>
      <%= collage.created_at.to_s(:simpledatetime) %>
      <% if collage.creators -%>
      by
      <%= raw collage.creators.collect { |u| link_to(u.display, user_path(u)) }.join(',') %>
      <% end -%>
      <% cache "collage-#{collage.id}-tags" do %>
      <% if collage.tag_list.any? -%>
      | <%= raw collage.tag_list.collect { |tag| link_to(tag, collage_tag_path(CGI.escape(tag))) }.join(', ') %>
      <% end -%>
      <% end -%>
    </p>
  </div>
  
  <% if current_user %>
  <div class="controls">
    <a href="<%= copy_collage_path(collage) %>" class="link-copy"><span class="icon icon-remix"></span>COPY COLLAGE</a>
    <a data-item_id="<%= collage.id %>" data-bookmarktype="item_collage" data-type="collage" class="link-add" href="#"><span class="icon icon-add"></span>ADD TO PLAYLIST</a>
    <%= link_to raw('<span class="icon icon-favorite"></span>BOOKMARK'), '#',
      :class => "link-bookmark bookmark-action", 
      "data-itemid" => collage.id,
      "data-type" => "collage" %>
  </div>
  <% end %>
  <div class="barcode_outer">
    <%= render :partial => "shared/barcode", :locals => { :object => collage } %>
  </div>
  <div class="cl"></div>
</li>
<% end -%>
